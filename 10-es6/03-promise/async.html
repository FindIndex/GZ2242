<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      // 错误写法
      //   function delay(ms) {
      //     setTimeout(function () {
      //       return Math.random();
      //     }, ms);

      //     return
      //   }
      function delay(ms, n) {
        return new Promise((resolve, reject) => {
          setTimeout(resolve, ms, Math.random() + " " + n);
        });
      }
    </script>
    <!-- <script>
      //   let p1 = delay(1000);
      //   p1.then((res) => {
      //     console.log(res);
      //   });

      //   普通函数加上 async  就是异步函数
      //   function xxx() {
      //     console.log("xxx start");

      //     delay(3000).then((res) => {
      //       console.log(res);
      //     });

      //     console.log("xxx end");
      //   }
      //   xxx();

      //   已经变成异步函数  async 一般需要配合 await使用
      //   使用 await 必须在 async函数内部
      async function xxx() {
        console.log("xxx start");

        let p = await delay(3000);
        // await 等后面的 promise 完成
        // 加上 await p 就是 promise 的结果
        console.log(p);

        console.log("xxx end");
      }
      var x = xxx();

      //   async函数返回一个 Promise 对象，可以使用then方法添加回调函数。
      // 当函数执行的时候，一旦遇到await就会先返回，等到异步操作完成，再接着执行函数体内后面的语句。
    </script> -->

    <!-- <script>
      let p1 = delay(5000, 1);
      let p2 = delay(3000, 2);

    //   Promise.all([p1, p2]).then((res) => {
    //     console.log(res);
    //   });
    </script> -->

    <script>
      async function xxx() {
        // console.log("xxx start");

        let p2 = await delay(3000, 2);
        // console.log(p2);

        let p1 = await delay(5000, 1);
        // console.log(p1);

        // console.log("xxx end");

        return p1;
      }
      //   xxx().then((res) => {
      //     console.log(res);
      //   });

      //   await 必须放在 async函数内部
      (async () => {
        let p = await xxx();
        console.log(p);
      })();
    </script>
  </body>
</html>
